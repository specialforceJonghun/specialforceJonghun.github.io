```python
from sklearn import datasets
from sklearn.preprocessing import PolynomialFeatures
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error
```


```python
import pandas as pd
```


```python
diabetes_dataset = datasets.load_diabetes()
```


```python
diabetes_dataset.data
```




    array([[ 0.03807591,  0.05068012,  0.06169621, ..., -0.00259226,
             0.01990842, -0.01764613],
           [-0.00188202, -0.04464164, -0.05147406, ..., -0.03949338,
            -0.06832974, -0.09220405],
           [ 0.08529891,  0.05068012,  0.04445121, ..., -0.00259226,
             0.00286377, -0.02593034],
           ...,
           [ 0.04170844,  0.05068012, -0.01590626, ..., -0.01107952,
            -0.04687948,  0.01549073],
           [-0.04547248, -0.04464164,  0.03906215, ...,  0.02655962,
             0.04452837, -0.02593034],
           [-0.04547248, -0.04464164, -0.0730303 , ..., -0.03949338,
            -0.00421986,  0.00306441]])




```python
polynomial_transformer = PolynomialFeatures(2)
```


```python
polynomial_data = polynomial_transformer.fit_transform(diabetes_dataset.data)
```


```python
polynomial_feature_names = polynomial_transformer.get_feature_names(diabetes_dataset.feature_names)
```


```python
X = pd.DataFrame(polynomial_data, columns = polynomial_feature_names)
X
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>age</th>
      <th>sex</th>
      <th>bmi</th>
      <th>bp</th>
      <th>s1</th>
      <th>s2</th>
      <th>s3</th>
      <th>s4</th>
      <th>s5</th>
      <th>...</th>
      <th>s3^2</th>
      <th>s3 s4</th>
      <th>s3 s5</th>
      <th>s3 s6</th>
      <th>s4^2</th>
      <th>s4 s5</th>
      <th>s4 s6</th>
      <th>s5^2</th>
      <th>s5 s6</th>
      <th>s6^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>0.038076</td>
      <td>0.050680</td>
      <td>0.061696</td>
      <td>0.021872</td>
      <td>-0.044223</td>
      <td>-0.034821</td>
      <td>-0.043401</td>
      <td>-0.002592</td>
      <td>0.019908</td>
      <td>...</td>
      <td>0.001884</td>
      <td>0.000113</td>
      <td>-0.000864</td>
      <td>0.000766</td>
      <td>0.000007</td>
      <td>-0.000052</td>
      <td>0.000046</td>
      <td>0.000396</td>
      <td>-0.000351</td>
      <td>0.000311</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>-0.001882</td>
      <td>-0.044642</td>
      <td>-0.051474</td>
      <td>-0.026328</td>
      <td>-0.008449</td>
      <td>-0.019163</td>
      <td>0.074412</td>
      <td>-0.039493</td>
      <td>-0.068330</td>
      <td>...</td>
      <td>0.005537</td>
      <td>-0.002939</td>
      <td>-0.005085</td>
      <td>-0.006861</td>
      <td>0.001560</td>
      <td>0.002699</td>
      <td>0.003641</td>
      <td>0.004669</td>
      <td>0.006300</td>
      <td>0.008502</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>0.085299</td>
      <td>0.050680</td>
      <td>0.044451</td>
      <td>-0.005671</td>
      <td>-0.045599</td>
      <td>-0.034194</td>
      <td>-0.032356</td>
      <td>-0.002592</td>
      <td>0.002864</td>
      <td>...</td>
      <td>0.001047</td>
      <td>0.000084</td>
      <td>-0.000093</td>
      <td>0.000839</td>
      <td>0.000007</td>
      <td>-0.000007</td>
      <td>0.000067</td>
      <td>0.000008</td>
      <td>-0.000074</td>
      <td>0.000672</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>-0.089063</td>
      <td>-0.044642</td>
      <td>-0.011595</td>
      <td>-0.036656</td>
      <td>0.012191</td>
      <td>0.024991</td>
      <td>-0.036038</td>
      <td>0.034309</td>
      <td>0.022692</td>
      <td>...</td>
      <td>0.001299</td>
      <td>-0.001236</td>
      <td>-0.000818</td>
      <td>0.000337</td>
      <td>0.001177</td>
      <td>0.000779</td>
      <td>-0.000321</td>
      <td>0.000515</td>
      <td>-0.000212</td>
      <td>0.000088</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>0.005383</td>
      <td>-0.044642</td>
      <td>-0.036385</td>
      <td>0.021872</td>
      <td>0.003935</td>
      <td>0.015596</td>
      <td>0.008142</td>
      <td>-0.002592</td>
      <td>-0.031991</td>
      <td>...</td>
      <td>0.000066</td>
      <td>-0.000021</td>
      <td>-0.000260</td>
      <td>-0.000380</td>
      <td>0.000007</td>
      <td>0.000083</td>
      <td>0.000121</td>
      <td>0.001023</td>
      <td>0.001492</td>
      <td>0.002175</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>437</th>
      <td>1.0</td>
      <td>0.041708</td>
      <td>0.050680</td>
      <td>0.019662</td>
      <td>0.059744</td>
      <td>-0.005697</td>
      <td>-0.002566</td>
      <td>-0.028674</td>
      <td>-0.002592</td>
      <td>0.031193</td>
      <td>...</td>
      <td>0.000822</td>
      <td>0.000074</td>
      <td>-0.000894</td>
      <td>-0.000207</td>
      <td>0.000007</td>
      <td>-0.000081</td>
      <td>-0.000019</td>
      <td>0.000973</td>
      <td>0.000225</td>
      <td>0.000052</td>
    </tr>
    <tr>
      <th>438</th>
      <td>1.0</td>
      <td>-0.005515</td>
      <td>0.050680</td>
      <td>-0.015906</td>
      <td>-0.067642</td>
      <td>0.049341</td>
      <td>0.079165</td>
      <td>-0.028674</td>
      <td>0.034309</td>
      <td>-0.018118</td>
      <td>...</td>
      <td>0.000822</td>
      <td>-0.000984</td>
      <td>0.000520</td>
      <td>-0.001276</td>
      <td>0.001177</td>
      <td>-0.000622</td>
      <td>0.001526</td>
      <td>0.000328</td>
      <td>-0.000806</td>
      <td>0.001979</td>
    </tr>
    <tr>
      <th>439</th>
      <td>1.0</td>
      <td>0.041708</td>
      <td>0.050680</td>
      <td>-0.015906</td>
      <td>0.017282</td>
      <td>-0.037344</td>
      <td>-0.013840</td>
      <td>-0.024993</td>
      <td>-0.011080</td>
      <td>-0.046879</td>
      <td>...</td>
      <td>0.000625</td>
      <td>0.000277</td>
      <td>0.001172</td>
      <td>-0.000387</td>
      <td>0.000123</td>
      <td>0.000519</td>
      <td>-0.000172</td>
      <td>0.002198</td>
      <td>-0.000726</td>
      <td>0.000240</td>
    </tr>
    <tr>
      <th>440</th>
      <td>1.0</td>
      <td>-0.045472</td>
      <td>-0.044642</td>
      <td>0.039062</td>
      <td>0.001215</td>
      <td>0.016318</td>
      <td>0.015283</td>
      <td>-0.028674</td>
      <td>0.026560</td>
      <td>0.044528</td>
      <td>...</td>
      <td>0.000822</td>
      <td>-0.000762</td>
      <td>-0.001277</td>
      <td>0.000744</td>
      <td>0.000705</td>
      <td>0.001183</td>
      <td>-0.000689</td>
      <td>0.001983</td>
      <td>-0.001155</td>
      <td>0.000672</td>
    </tr>
    <tr>
      <th>441</th>
      <td>1.0</td>
      <td>-0.045472</td>
      <td>-0.044642</td>
      <td>-0.073030</td>
      <td>-0.081414</td>
      <td>0.083740</td>
      <td>0.027809</td>
      <td>0.173816</td>
      <td>-0.039493</td>
      <td>-0.004220</td>
      <td>...</td>
      <td>0.030212</td>
      <td>-0.006865</td>
      <td>-0.000733</td>
      <td>0.000533</td>
      <td>0.001560</td>
      <td>0.000167</td>
      <td>-0.000121</td>
      <td>0.000018</td>
      <td>-0.000013</td>
      <td>0.000009</td>
    </tr>
  </tbody>
</table>
<p>442 rows × 66 columns</p>
</div>




```python
y = pd.DataFrame(diabetes_dataset.target, columns = ['target'])
y
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>151.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>75.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>141.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>206.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>135.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>437</th>
      <td>178.0</td>
    </tr>
    <tr>
      <th>438</th>
      <td>104.0</td>
    </tr>
    <tr>
      <th>439</th>
      <td>132.0</td>
    </tr>
    <tr>
      <th>440</th>
      <td>220.0</td>
    </tr>
    <tr>
      <th>441</th>
      <td>57.0</td>
    </tr>
  </tbody>
</table>
<p>442 rows × 1 columns</p>
</div>




```python
X_train, X_test, y_train, y_test = train_test_split(X,y, test_size=0.2, random_state= 5)    
```


```python
model = LinearRegression()
```


```python
model.fit(X_train,y_train)
```




    LinearRegression()




```python
y_predict = model.predict(X_test)
```


```python
mean_squared_error(y_test, y_predict)**0.5  # 약 
```




    57.877049027249626




```python
diabetes_dataset.target
```




    array([151.,  75., 141., 206., 135.,  97., 138.,  63., 110., 310., 101.,
            69., 179., 185., 118., 171., 166., 144.,  97., 168.,  68.,  49.,
            68., 245., 184., 202., 137.,  85., 131., 283., 129.,  59., 341.,
            87.,  65., 102., 265., 276., 252.,  90., 100.,  55.,  61.,  92.,
           259.,  53., 190., 142.,  75., 142., 155., 225.,  59., 104., 182.,
           128.,  52.,  37., 170., 170.,  61., 144.,  52., 128.,  71., 163.,
           150.,  97., 160., 178.,  48., 270., 202., 111.,  85.,  42., 170.,
           200., 252., 113., 143.,  51.,  52., 210.,  65., 141.,  55., 134.,
            42., 111.,  98., 164.,  48.,  96.,  90., 162., 150., 279.,  92.,
            83., 128., 102., 302., 198.,  95.,  53., 134., 144., 232.,  81.,
           104.,  59., 246., 297., 258., 229., 275., 281., 179., 200., 200.,
           173., 180.,  84., 121., 161.,  99., 109., 115., 268., 274., 158.,
           107.,  83., 103., 272.,  85., 280., 336., 281., 118., 317., 235.,
            60., 174., 259., 178., 128.,  96., 126., 288.,  88., 292.,  71.,
           197., 186.,  25.,  84.,  96., 195.,  53., 217., 172., 131., 214.,
            59.,  70., 220., 268., 152.,  47.,  74., 295., 101., 151., 127.,
           237., 225.,  81., 151., 107.,  64., 138., 185., 265., 101., 137.,
           143., 141.,  79., 292., 178.,  91., 116.,  86., 122.,  72., 129.,
           142.,  90., 158.,  39., 196., 222., 277.,  99., 196., 202., 155.,
            77., 191.,  70.,  73.,  49.,  65., 263., 248., 296., 214., 185.,
            78.,  93., 252., 150.,  77., 208.,  77., 108., 160.,  53., 220.,
           154., 259.,  90., 246., 124.,  67.,  72., 257., 262., 275., 177.,
            71.,  47., 187., 125.,  78.,  51., 258., 215., 303., 243.,  91.,
           150., 310., 153., 346.,  63.,  89.,  50.,  39., 103., 308., 116.,
           145.,  74.,  45., 115., 264.,  87., 202., 127., 182., 241.,  66.,
            94., 283.,  64., 102., 200., 265.,  94., 230., 181., 156., 233.,
            60., 219.,  80.,  68., 332., 248.,  84., 200.,  55.,  85.,  89.,
            31., 129.,  83., 275.,  65., 198., 236., 253., 124.,  44., 172.,
           114., 142., 109., 180., 144., 163., 147.,  97., 220., 190., 109.,
           191., 122., 230., 242., 248., 249., 192., 131., 237.,  78., 135.,
           244., 199., 270., 164.,  72.,  96., 306.,  91., 214.,  95., 216.,
           263., 178., 113., 200., 139., 139.,  88., 148.,  88., 243.,  71.,
            77., 109., 272.,  60.,  54., 221.,  90., 311., 281., 182., 321.,
            58., 262., 206., 233., 242., 123., 167.,  63., 197.,  71., 168.,
           140., 217., 121., 235., 245.,  40.,  52., 104., 132.,  88.,  69.,
           219.,  72., 201., 110.,  51., 277.,  63., 118.,  69., 273., 258.,
            43., 198., 242., 232., 175.,  93., 168., 275., 293., 281.,  72.,
           140., 189., 181., 209., 136., 261., 113., 131., 174., 257.,  55.,
            84.,  42., 146., 212., 233.,  91., 111., 152., 120.,  67., 310.,
            94., 183.,  66., 173.,  72.,  49.,  64.,  48., 178., 104., 132.,
           220.,  57.])


